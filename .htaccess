## Security and clean URLs
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>

<IfModule mod_rewrite.c>
  RewriteEngine On

  # Force HTTPS if available
  RewriteCond %{HTTPS} !=on
  RewriteCond %{ENV:HTTPS} !=on
  RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=302,L]

  # Redirect *.php to extensionless URL
  RewriteCond %{THE_REQUEST} \s/([^\s?]+)\.php[\s?]
  RewriteRule ^ %1 [R=301,L]

  # Serve existing files/directories
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Map extensionless to PHP files
  RewriteRule ^(.+)$ $1.php [L,QSA]
</IfModule>

## Disable directory listing
Options -Indexes

## Deny access to sensitive files
<FilesMatch "\.(env|ini|log|sql|sh|bat)$">
  Require all denied
</FilesMatch>

<Files ".git*">
  Require all denied
</Files>
# /var/www/birkityt/.htaccess
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Запретить прямой доступ к .htaccess
  <Files ".htaccess">
    Require all denied
  </Files>

  # Если запрашивается путь без расширения — пробуем добавить .php
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^([^\.]+)$ $1.php [NC,L]
</IfModule>